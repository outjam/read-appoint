# Заявки на подключение

## Общая концепция

**Заявка на подключение** — единая форма, через которую мерчант может подключиться к сервису appoint разными путями:
- Прямая регистрация через сайт appoint
- Интеграция через YCLIENTS
- Интеграция через 1С:Фитнес

---

## 3. Унифицированные шаги

### Шаг 1 — Данные представителя

#### Поля:
- ФИО (обязательное)
- Телефон (обязательное)
- Email (обязательное)

#### Поведение формы:
- Валидация происходит после потери фокуса.
- Телефон автоматически:
  - заменяет 8 → +7
  - обрезает +7 при вставке
- Кнопка «Продолжить» — 'disabled', пока поля невалидны.
- При отправки данных из формаы кнопка с атрибутом 'loading'

#### Ошибки:

**Телефон:**
- Неверный формат номера телефона
- Этот номер телефона уже зарегистрирован
- Номер телефона заблокирован

**Почта:**
- Неверный формат почты
- Эта почта уже зарегистрирована
- Почта заблокирована

---

## 4. Подтверждение телефона *(OTP)*
Обязательно во всех сценариях.

**Логика:**
1. Отправка SMS
2. Экран ввода кода
3. Таймер
4. Возможность повторной отправки

**Ошибки**:
- Неверный код
- Вы неверно ввели код несколько раз
- Ограничения по попыткам

---

## 5. Шаг 2 — Юридические данные *(если применимо)*
> ⛔ Не используется в сценарии 1С:Фитнес.

### Отображение формы:

**Сначала доступно только:**
- Тип юр. лица
- ИНН
- Город

### Автозаполнение:

**После ввода ИНН:**
- → запрос в DaData
- → поля заполняются автоматически

### Ошибки:
- Такого ИНН не существует
- Этот ИНН уже используется
- Неверный формат ИНН

---

## 6. Сценарии интеграций

### YCLIENTS

**Точка входа:**
> merchant.appoint.ru/sign-up

**Особенности:**
- ФИО / телефон / email предзаполнены
- Пользователь может изменить значения
- Полное совпадение UI со стандартным сценарием

**Источник заявки:**
> yclients

---

### 1С:Фитнес

**Точка входа:**
> merchant.appoint.ru/sign-up

**Особенности:**
- Только контактные данные
- Без шага авто-заполнения по ИНН

**Источник заявки:**
> 1c_fitness

## 7. После отправки заявки
**Единый статусный экран:**
- «Мы скоро вам позвоним»
- «Ваша заявка принята»

**В админ-панели:**
- фиксируется источник (appoint / yclients / 1c_fitness)
- заявка уходит в статус "Новая"
  
> Редактирование запрещено.

---

## 8. Логика повторных регистраций

| Ситуация                            | Поведение             |
| ----------------------------------- | --------------------- |
| Телефон есть в незавершённой заявке | Предложить продолжить |
| Телефон в заявке в модерации        | Редирект в ЛК         |
| Телефон уже в существующем бренде   | Ошибка                |
| Email уже в системе                 | Ошибка                |
| ИНН уже используется                | Ошибка                |
